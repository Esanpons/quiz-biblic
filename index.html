<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz B√≠blic S√∫per Genial!</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes wiggle {
            0%, 7% { transform: rotateZ(0); }
            15% { transform: rotateZ(-15deg); }
            20% { transform: rotateZ(10deg); }
            25% { transform: rotateZ(-10deg); }
            30% { transform: rotateZ(6deg); }
            35% { transform: rotateZ(-4deg); }
            40%, 100% { transform: rotateZ(0); }
        }
        
        .animate-wiggle {
            animation: wiggle 2s ease-in-out infinite;
        }
        
        .animate-spin-slow {
            animation: spin 3s linear infinite;
        }

        /* Configuraci√≥ custom de Tailwind */
        .bg-clip-text {
            background-clip: text;
            -webkit-background-clip: text;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // Icones simplificades
        const Brain = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
        );

        const Trophy = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V7C19 10.31 16.31 13 13 13H11C7.69 13 5 10.31 5 7V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V7C7 9.21 8.79 11 11 11H13C15.21 11 17 9.21 17 7V6H7Z"/>
                <path d="M9 15H15V17H9V15ZM7 19H17V21H7V19Z"/>
            </svg>
        );

        const ArrowRight = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </svg>
        );

        const RotateCcw = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M1 4v6h6M3.51 15a9 9 0 1 0 2.13-9.36L1 10" />
            </svg>
        );

        const Loader2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
            </svg>
        );

        const Star = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
            </svg>
        );

        const Heart = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
            </svg>
        );

        const Sparkles = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 1L9 9L1 12L9 15L12 23L15 15L23 12L15 9L12 1Z" />
            </svg>
        );

        const QuizBiblic = () => {
            const [nivell, setNivell] = useState(1);
            const [puntuacio, setPuntuacio] = useState(0);
            const [preguntaActual, setPreguntaActual] = useState(null);
            const [respostaSeleccionada, setRespostaSeleccionada] = useState('');
            const [mostrarResultat, setMostrarResultat] = useState(false);
            const [carregant, setCarregant] = useState(false);
            const [historialPreguntes, setHistorialPreguntes] = useState([]);
            const [correctesConsecutives, setCorrectesConsecutives] = useState(0);
            const [preguntes, setPreguntes] = useState({});
            const [preguntesUsades, setPreguntesUsades] = useState(new Set());

            const nivellsNoms = {
                1: 'Petit Explorer üå±',
                2: 'Jove Aventurer ü¶ã',
                3: 'Savi Descobridor üåü',
                4: 'Mestre B√≠blic üëë',
                5: 'Llegenda Sagrada ‚ú®'
            };

            const emojisNivell = {
                1: 'üå±',
                2: 'ü¶ã', 
                3: 'üåü',
                4: 'üëë',
                5: '‚ú®'
            };

            // Carregar preguntes del JSON
            useEffect(() => {
                const carregarPreguntes = async () => {
                    try {
                        const response = await fetch('./preguntes.json');
                        const data = await response.json();
                        setPreguntes(data);
                    } catch (error) {
                        console.error('Error carregant preguntes:', error);
                        // Preguntes de fallback
                        setPreguntes({
                            nivell1: [{
                                pregunta: "Quin va ser el primer home que D√©u va crear?",
                                opcions: ["A) Abel", "B) Adam", "C) No√®", "D) Abraham"],
                                resposta_correcta: "B",
                                explicacio: "Adam va ser el primer home que D√©u va crear del fang de la terra!"
                            }]
                        });
                    }
                };

                carregarPreguntes();
            }, []);

            const seleccionarPregunta = useCallback(() => {
                const preguntesNivell = preguntes[`nivell${nivell}`] || [];
                if (preguntesNivell.length === 0) return null;

                // Filtra preguntes no usades
                const preguntesDisponibles = preguntesNivell.filter((_, index) => 
                    !preguntesUsades.has(`${nivell}-${index}`)
                );

                // Si s'han usat totes, reinicia per aquest nivell
                if (preguntesDisponibles.length === 0) {
                    const novesUsades = new Set([...preguntesUsades].filter(key => !key.startsWith(`${nivell}-`)));
                    setPreguntesUsades(novesUsades);
                    return preguntesNivell[Math.floor(Math.random() * preguntesNivell.length)];
                }

                const indexOriginal = preguntesNivell.findIndex(p => preguntesDisponibles.includes(p));
                const preguntaSeleccionada = preguntesDisponibles[Math.floor(Math.random() * preguntesDisponibles.length)];
                
                // Marca com usada
                setPreguntesUsades(prev => new Set([...prev, `${nivell}-${indexOriginal}`]));
                
                return preguntaSeleccionada;
            }, [nivell, preguntes, preguntesUsades]);

            const generarPregunta = useCallback(() => {
                setCarregant(true);
                setTimeout(() => {
                    const novaPregunta = seleccionarPregunta();
                    setPreguntaActual(novaPregunta);
                    setRespostaSeleccionada('');
                    setMostrarResultat(false);
                    setCarregant(false);
                }, 500);
            }, [seleccionarPregunta]);

            const comprovarResposta = () => {
                if (!respostaSeleccionada || !preguntaActual) return;

                const esCorrecta = respostaSeleccionada === preguntaActual.resposta_correcta;
                setMostrarResultat(true);

                setHistorialPreguntes(prev => [...prev, {
                    ...preguntaActual,
                    respostaUsuari: respostaSeleccionada,
                    correcta: esCorrecta
                }]);

                if (esCorrecta) {
                    setPuntuacio(prev => prev + nivell * 10);
                    setCorrectesConsecutives(prev => prev + 1);
                    
                    if (correctesConsecutives >= 1 && nivell < 5) {
                        setNivell(prev => prev + 1);
                        setCorrectesConsecutives(0);
                    }
                } else {
                    setCorrectesConsecutives(0);
                    if (nivell > 1) {
                        setNivell(prev => prev - 1);
                    }
                }
            };

            const seguentPregunta = () => {
                generarPregunta();
            };

            const reiniciarQuiz = () => {
                setNivell(1);
                setPuntuacio(0);
                setPreguntaActual(null);
                setRespostaSeleccionada('');
                setMostrarResultat(false);
                setHistorialPreguntes([]);
                setCorrectesConsecutives(0);
                setPreguntesUsades(new Set());
            };

            const iniciarQuiz = () => {
                generarPregunta();
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-pink-300 via-purple-300 to-indigo-400 p-4 relative overflow-hidden">
                    {/* Elements decoratius animats */}
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        <div className="absolute top-10 left-10 animate-bounce">
                            <Star className="text-yellow-300 w-8 h-8 animate-pulse" />
                        </div>
                        <div className="absolute top-20 right-16 animate-bounce delay-300">
                            <Heart className="text-pink-300 w-6 h-6 animate-pulse" />
                        </div>
                        <div className="absolute bottom-20 left-20 animate-bounce delay-500">
                            <Sparkles className="text-purple-300 w-7 h-7 animate-pulse" />
                        </div>
                        <div className="absolute top-1/3 right-8 animate-bounce delay-700">
                            <Star className="text-blue-300 w-5 h-5 animate-pulse" />
                        </div>
                        <div className="absolute bottom-32 right-1/4 animate-bounce delay-1000">
                            <Heart className="text-yellow-300 w-6 h-6 animate-pulse" />
                        </div>
                    </div>

                    <div className="max-w-4xl mx-auto relative z-10">
                        {/* Header s√∫per colorit */}
                        <div className="text-center mb-8">
                            <div className="flex items-center justify-center gap-3 mb-4">
                                <div className="animate-spin-slow">
                                    <Brain className="text-yellow-400 w-12 h-12 drop-shadow-lg" />
                                </div>
                                <h1 className="text-5xl font-black text-white drop-shadow-lg animate-pulse">
                                    Quiz B√≠blic S√∫per Genial!
                                </h1>
                                <div className="animate-bounce">
                                    <Trophy className="text-yellow-400 w-12 h-12 drop-shadow-lg" />
                                </div>
                            </div>
                            <p className="text-purple-800 text-xl font-bold drop-shadow-md animate-wiggle">
                                üéâ Descobreix les hist√≤ries m√©s emocionants de la B√≠blia! üéâ
                            </p>
                        </div>

                        {/* Stats s√∫per animats */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div className="bg-gradient-to-br from-yellow-300 to-orange-400 rounded-3xl p-6 text-center transform hover:scale-105 transition-all duration-300 shadow-xl border-4 border-white">
                                <div className="text-4xl font-black text-white drop-shadow-lg animate-bounce">
                                    {emojisNivell[nivell]} {nivell}
                                </div>
                                <div className="text-purple-800 font-bold text-lg">{nivellsNoms[nivell]}</div>
                            </div>
                            <div className="bg-gradient-to-br from-green-300 to-emerald-400 rounded-3xl p-6 text-center transform hover:scale-105 transition-all duration-300 shadow-xl border-4 border-white">
                                <div className="text-4xl font-black text-white drop-shadow-lg animate-pulse">‚ú® {puntuacio}</div>
                                <div className="text-purple-800 font-bold text-lg">Punts M√†gics!</div>
                            </div>
                            <div className="bg-gradient-to-br from-pink-300 to-rose-400 rounded-3xl p-6 text-center transform hover:scale-105 transition-all duration-300 shadow-xl border-4 border-white">
                                <div className="text-4xl font-black text-white drop-shadow-lg animate-bounce">üéØ {historialPreguntes.length}</div>
                                <div className="text-purple-800 font-bold text-lg">Preguntes Fetes</div>
                            </div>
                        </div>

                        {/* Contingut principal s√∫per animat */}
                        <div className="bg-gradient-to-br from-white to-blue-50 rounded-3xl p-8 mb-6 shadow-2xl border-4 border-purple-300">
                            {!preguntaActual && !carregant ? (
                                <div className="text-center">
                                    <div className="text-8xl mb-6 animate-bounce">üåà</div>
                                    <h2 className="text-4xl font-black text-purple-700 mb-6 animate-pulse">
                                        Benvingut a l'Aventura B√≠blica!
                                    </h2>
                                    <p className="text-purple-600 mb-8 text-xl font-bold leading-relaxed">
                                        üéÆ Prepara't per a un viatge incre√Øble per les hist√≤ries m√©s emocionants de la B√≠blia! <br/>
                                        üåü Cada resposta correcta et fa pujar de nivell! <br/>
                                        üéØ Quantes preguntes podr√†s respondre correctament?
                                    </p>
                                    <button
                                        onClick={iniciarQuiz}
                                        className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-12 py-6 rounded-3xl font-black text-2xl transition-all duration-300 transform hover:scale-110 shadow-xl border-4 border-white animate-pulse"
                                    >
                                        üöÄ Comen√ßar l'Aventura! üöÄ
                                    </button>
                                </div>
                            ) : carregant ? (
                                <div className="text-center py-12">
                                    <div className="text-8xl mb-4 animate-spin">üåü</div>
                                    <Loader2 className="w-16 h-16 text-purple-500 animate-spin mx-auto mb-4" />
                                    <p className="text-purple-600 text-2xl font-bold animate-pulse">Preparant una pregunta s√∫per genial...</p>
                                </div>
                            ) : (
                                <div>
                                    <div className="mb-6">
                                        <div className="flex items-center justify-between mb-6">
                                            <div className="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-2xl font-black text-lg shadow-lg border-2 border-white">
                                                {emojisNivell[nivell]} {nivellsNoms[nivell]}
                                            </div>
                                            <div className="text-purple-600 font-bold text-lg animate-pulse">
                                                Pregunta #{historialPreguntes.length + 1} üéØ
                                            </div>
                                        </div>
                                        <div className="bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-2xl border-4 border-purple-300 mb-6">
                                            <h3 className="text-2xl font-black text-purple-800 leading-relaxed animate-pulse">
                                                ü§î {preguntaActual.pregunta}
                                            </h3>
                                        </div>
                                    </div>

                                    <div className="space-y-4 mb-6">
                                        {preguntaActual.opcions.map((opcio, index) => {
                                            const lletra = opcio.charAt(0);
                                            const isSelected = respostaSeleccionada === lletra;
                                            const isCorrect = lletra === preguntaActual.resposta_correcta;
                                            
                                            let bgClass = 'bg-gradient-to-r from-gray-100 to-gray-200 hover:from-purple-200 hover:to-pink-200';
                                            let borderClass = 'border-purple-300';
                                            let textClass = 'text-purple-800';
                                            let emoji = 'ü§∑‚Äç‚ôÄÔ∏è';
                                            
                                            if (mostrarResultat) {
                                                if (isCorrect) {
                                                    bgClass = 'bg-gradient-to-r from-green-300 to-emerald-400';
                                                    borderClass = 'border-green-500';
                                                    textClass = 'text-white';
                                                    emoji = '‚úÖ';
                                                } else if (isSelected && !isCorrect) {
                                                    bgClass = 'bg-gradient-to-r from-red-300 to-pink-400';
                                                    borderClass = 'border-red-500';
                                                    textClass = 'text-white';
                                                    emoji = '‚ùå';
                                                }
                                            } else if (isSelected) {
                                                bgClass = 'bg-gradient-to-r from-purple-400 to-pink-400';
                                                borderClass = 'border-purple-500';
                                                textClass = 'text-white';
                                                emoji = 'üëÜ';
                                            }

                                            return React.createElement('button', {
                                                key: index,
                                                onClick: () => !mostrarResultat && setRespostaSeleccionada(lletra),
                                                disabled: mostrarResultat,
                                                className: `w-full p-4 rounded-2xl border-4 text-left transition-all duration-300 font-bold text-lg ${bgClass} ${borderClass} ${!mostrarResultat ? 'hover:scale-105 transform' : ''} shadow-lg`
                                            }, React.createElement('span', {
                                                className: textClass
                                            }, `${emoji} ${opcio}`));
                                        })}
                                    </div>

                                    {mostrarResultat && (
                                        <div className="bg-gradient-to-r from-blue-100 to-purple-100 rounded-2xl p-6 mb-6 border-4 border-blue-300 shadow-lg">
                                            <div className={`text-center mb-4 ${respostaSeleccionada === preguntaActual.resposta_correcta ? 'text-green-600' : 'text-red-600'}`}>
                                                <div className="text-6xl mb-2">
                                                    {respostaSeleccionada === preguntaActual.resposta_correcta ? 'üéâ' : 'üòÖ'}
                                                </div>
                                                <h4 className="text-3xl font-black mb-2 animate-bounce">
                                                    {respostaSeleccionada === preguntaActual.resposta_correcta ? '¬°S√∫per b√©!' : 'Quasi ho tens!'}
                                                </h4>
                                            </div>
                                            <div className="bg-white rounded-xl p-4 border-2 border-purple-200">
                                                <p className="text-purple-800 leading-relaxed font-bold">
                                                    <strong>üß† Sabies que...</strong> {preguntaActual.explicacio}
                                                </p>
                                            </div>
                                        </div>
                                    )}

                                    <div className="flex gap-4">
                                        {!mostrarResultat ? (
                                            <button
                                                onClick={comprovarResposta}
                                                disabled={!respostaSeleccionada}
                                                className="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:from-gray-400 disabled:to-gray-500 text-white px-8 py-4 rounded-2xl font-black text-xl transition-all duration-300 disabled:cursor-not-allowed transform hover:scale-105 shadow-lg border-2 border-white"
                                            >
                                                üéØ Comprovar Resposta!
                                            </button>
                                        ) : (
                                            <button
                                                onClick={seguentPregunta}
                                                className="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-8 py-4 rounded-2xl font-black text-xl transition-all duration-300 flex items-center justify-center gap-3 transform hover:scale-105 shadow-lg border-2 border-white"
                                            >
                                                üöÄ Seg√ºent Aventura!
                                                <ArrowRight className="w-6 h-6" />
                                            </button>
                                        )}
                                        
                                        <button
                                            onClick={reiniciarQuiz}
                                            className="bg-gradient-to-r from-orange-400 to-red-400 hover:from-orange-500 hover:to-red-500 text-white px-8 py-4 rounded-2xl font-black text-xl transition-all duration-300 flex items-center gap-3 transform hover:scale-105 shadow-lg border-2 border-white"
                                        >
                                            <RotateCcw className="w-6 h-6" />
                                            üîÑ Reiniciar
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Progres s√∫per colorit */}
                        {historialPreguntes.length > 0 && (
                            <div className="bg-gradient-to-r from-white to-yellow-50 rounded-2xl p-6 border-4 border-yellow-300 shadow-lg">
                                <h3 className="text-2xl font-black text-purple-700 mb-4 animate-pulse">
                                    üåü Les Teves √öltimes Aventures
                                </h3>
                                <div className="flex gap-3 flex-wrap">
                                    {historialPreguntes.slice(-10).map((pregunta, index) => (
                                        React.createElement('div', {
                                            key: index,
                                            className: `w-12 h-12 rounded-full flex items-center justify-center text-2xl font-black border-4 border-white shadow-lg transform hover:scale-125 transition-all duration-300 ${
                                                pregunta.correcta 
                                                    ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white animate-bounce' 
                                                    : 'bg-gradient-to-r from-red-400 to-pink-500 text-white animate-wiggle'
                                            }`,
                                            title: pregunta.pregunta
                                        }, pregunta.correcta ? 'üéâ' : 'üí™')
                                    ))}
                                </div>
                                <p className="text-purple-600 font-bold mt-3 text-center">
                                    {historialPreguntes.filter(p => p.correcta).length} correctes de {historialPreguntes.length} preguntes! üéØ
                                </p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<QuizBiblic />, document.getElementById('root'));
    </script>
</body>
</html>